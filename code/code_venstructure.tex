\begin{mdframed}
\begin{minipage}{\linewidth}
\small
\belowcaptionskip=-10pt
\begin{lstlisting}[mathescape,label=alg:structureVent,basicstyle=\selectfont\ttfamily,numbers=none,caption={Structure
Learning},escapechar=\#]
// GRAMMAR FOR KERNEL STRUCTURE
#\linenumber{1}#assume kernels = list(se, wn, lin, per, rq) // defined as above

// prior on the number of kernels
#\linenumber{2}#assume p_number_k = uniform_structure(n)
#\linenumber{3}#assume subset_kernels = tag(quote(grammar), 0,
#\linenumber{4}#                            subset(kernels, p_number_k))

// kernel composition
#\linenumber{5}#assume composition = proc(l) {
#\linenumber{6}#  if (size(l) <= 1) {
#\linenumber{7}#    first(l)
#\linenumber{8}#  } else {
#\linenumber{9}#    if (bernoulli()) {
#\linenumber{10}#      add_funcs(first(l), composition(rest(l)))
#\linenumber{11}#    } else {
#\linenumber{12}#       mult_funcs(first(l), composition(rest(l)))
#\linenumber{13}#    }
#\linenumber{14}#  }
#\linenumber{15}#}

#\linenumber{16}#assume K = tag(quote(grammar), 1, composition(subset_kernels))

// APPLY GPMEM
#\linenumber{17}#assume (f_compute, f_emu) = gpmem(f_look_up, K)

// Probe all data points
#\linenumber{18}#for n ... N
#\linenumber{19}#  predict f_compute(get_data_xs(n))

// PERFORMING INFERENCE
#\linenumber{20}#infer repeat(2000, do(
#\linenumber{21}#  mh(quote(grammar), one, 1),
#\linenumber{22}#  mh(quote(parameters), one, 2)))
\end{lstlisting}

\end{minipage}
\end{mdframed}
